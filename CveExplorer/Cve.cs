using System.Text.Json.Serialization;

namespace CveExplorer;

public record Cve
{
    [JsonPropertyName("Modified")]
    public DateTime Modified { get; init; }

    [JsonPropertyName("Published")]
    public DateTime Published { get; init; }

    public Access? Access { get; set; }

    public string Assigner { get; set; } = "";

    public List<Capec>? Capec { get; set; }

    [JsonIgnore]
    public double Cvss => CvssScore ?? 0;

    [JsonPropertyName("cvss")]
    public double? CvssScore { get; set; }

    [JsonPropertyName("cvss-time")]
    public DateTime? CvssTime { get; set; }

    [JsonPropertyName("cvss-vector")]
    public string CvssVector { get; init; } = "";

    public string Cwe { get; init; } = "";

    public string Id { get; set; } = "";
    public Impact? Impact { get; set; }

    [JsonPropertyName("last-modified")]
    public DateTime LastModified { get; set; }

    public List<string>? References { get; set; }

    public string Summary { get; set; } = "";

    [JsonPropertyName("vulnerable_configuration")]
    public List<VulnerableConfiguration>? VulnerableConfiguration { get; set; }

    [JsonPropertyName("vulnerable_configuration_cpe_2_2")]
    public List<object>? VulnerableConfigurationCpe22 { get; set; }

    [JsonPropertyName("vulnerable_product")]
    public List<string>? VulnerableProduct { get; set; }
}

public sealed record Access
{
    [JsonPropertyName("authentication")]
    public string Authentication { get; set; } = "";

    [JsonPropertyName("complexity")]
    public string Complexity { get; set; } = "";

    [JsonPropertyName("vector")]
    public string Vector { get; set; } = "";
}

public class Capec
{
    [JsonPropertyName("id")]
    public string Id { get; set; } = "";

    [JsonPropertyName("name")]
    public string Name { get; set; } = "";

    [JsonPropertyName("prerequisites")]
    public string PreRequisites { get; set; } = "";

    [JsonPropertyName("related_weakness")]
    public List<string>? RelatedWeakness { get; set; }

    [JsonPropertyName("solutions")]
    public string Solutions { get; set; } = "";

    [JsonPropertyName("summary")]
    public string Summary { get; set; } = "";
}

public class Impact
{
    public string Availability { get; set; } = "";
    public string Confidentiality { get; set; } = "";
    public string Integrity { get; set; } = "";
}

public class VulnerableConfiguration
{
    public string Id { get; set; } = "";
    public string Title { get; set; } = "";
}