namespace CveExplorer.Winforms;

public partial class MainForm : Form
{
    private const string FormatoData = "dd/MM/yyyy HH:mm";

    public MainForm()
    {
        InitializeComponent();
    }

    private async void btBuscarCve_Click(object sender, EventArgs e)
    {
        var api = new CveApi();
        var cve = await api.GetById(txtCodigoCve.Text);

        txtSummary.Text = cve.Summary;
        txtPublished.Text = cve.Published.ToString(FormatoData);
        txtModified.Text = cve.Modified.ToString(FormatoData);
        txtLastModified.Text = cve.LastModified.ToString(FormatoData);
        txtAssigner.Text = cve.Assigner;

        txtAuthentication.Text = cve.Access?.Authentication ?? "";
        txtComplexity.Text = cve.Access?.Complexity ?? "";
        txtVector.Text = cve.Access?.Vector ?? "";

        txtCvss.Text = cve.Cvss.ToString("N2");
        txtCvssTime.Text = cve.CvssTime.ToString(FormatoData);
        txtCvssVector.Text = cve.CvssVector;

        txtCwe.Text = cve.Cwe;

        txtAvailability.Text = cve.Impact?.Availability ?? "";
        txtConfidentiality.Text = cve.Impact?.Confidentiality ?? "";
        txtIntegrity.Text = cve.Impact.Integrity ?? "";

    }

    private void label2_Click(object sender, EventArgs e)
    {

    }
}
